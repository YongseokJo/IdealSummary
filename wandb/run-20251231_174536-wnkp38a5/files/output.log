
Operator scope: simple

Initial model:
============================================================
Set-DSR Model Summary
============================================================
Number of summaries (K): 12
Total complexity: 89.00
------------------------------------------------------------
s_0: (identity_s(SUM((m * logM))) + SUM(abs((square(identity(logM)) * (logM - (logM - logM))))))
     complexity: 9.00, depth: 7
s_1: WSUM((logM * (m * m)))
     complexity: 4.00, depth: 4
s_2: square_s((0.6451 * identity_s(identity_s(WMEAN((logM - m))))))
     complexity: 5.50, depth: 7
s_3: WSUM(((((square(logM) + (logM + logM)) * (logM - (m * logM))) * ((square(logM) * m) - ((m - logM) - (m + logM)))) * (logM + (square(1.9845) - abs((logM + m))))))
     complexity: 21.50, depth: 7
s_4: square_s(WMEAN(logM))
     complexity: 3.00, depth: 3
s_5: square_s(identity_s((square_s(identity_s(MEAN(logM))) + (1.7164 - square_s(MEAN(logM))))))
     complexity: 7.50, depth: 7
s_6: -0.0560
     complexity: 0.50, depth: 1
s_7: 1.0424
     complexity: 0.50, depth: 1
s_8: identity_s((WMEAN(((m * 0.6867) * 1.5985)) * (WSUM(logM) + (0.5244 + SUM((logM + m))))))
     complexity: 12.50, depth: 7
s_9: ((square_s(WMEAN((m + -0.3556))) * identity_s((-0.3895 * SUM(logM)))) + ((((0.6086 * (MEAN(logM) + WMEAN(logM))) + identity_s(SUM(m))) - WMEAN(m)) + WSUM(logM)))
     complexity: 22.50, depth: 8
s_10: (-0.7456 * -0.0928)
     complexity: 2.00, depth: 2
s_11: identity_s(0.0313)
     complexity: 0.50, depth: 2
============================================================

Using advanced GP evolver (subtree_mutation=True, const_opt=True)

============================================================
Phase 1: Evolutionary Search (GP)
============================================================

[Gen 0] Advancing curriculum to level 1
[Gen    0] fitness=nan, val_mse=1.7501e+08, val_r2=-4946228405.2992, complexity=52.50
[Gen   10] fitness=nan, val_mse=8.0709e-02, val_r2=-1.2811, complexity=137.00
[Gen   20] fitness=nan, val_mse=2.1412e+13, val_r2=-605168938770406.6250, complexity=145.50

[Gen 30] Advancing curriculum to level 2
[Gen   30] fitness=nan, val_mse=4.7381e+28, val_r2=-1339134157610886385170898747392.0000, complexity=122.00
[Gen   40] fitness=nan, val_mse=4.4980e+04, val_r2=-1271277.5497, complexity=118.50
[Gen   50] fitness=nan, val_mse=1.4257e+04, val_r2=-402934.8239, complexity=124.00

[Gen 60] Advancing curriculum to level 3
[Gen   60] fitness=nan, val_mse=7.8136e-02, val_r2=-1.2084, complexity=167.50
[Gen   70] fitness=nan, val_mse=8.0199e-02, val_r2=-1.2667, complexity=170.00
[Gen   80] fitness=nan, val_mse=3.9809e-02, val_r2=-0.1251, complexity=130.00
[Gen   90] fitness=nan, val_mse=4.3861e-02, val_r2=-0.2396, complexity=147.00
[Gen  100] fitness=nan, val_mse=1.5540e+07, val_r2=-439218113.6197, complexity=140.00
[Gen  110] fitness=nan, val_mse=5.3719e-02, val_r2=-0.5183, complexity=166.00
[Gen  120] fitness=nan, val_mse=4.7808e+00, val_r2=-134.1193, complexity=137.00
[Gen  130] fitness=nan, val_mse=2.7053e-02, val_r2=0.2354, complexity=171.00
[Gen  140] fitness=nan, val_mse=2.6667e-02, val_r2=0.2463, complexity=180.00
[Gen  150] fitness=nan, val_mse=2.8087e-02, val_r2=0.2062, complexity=183.50
[Gen  160] fitness=nan, val_mse=1.7669e+14, val_r2=-4993760006364566.0000, complexity=171.00
[Gen  170] fitness=nan, val_mse=inf, val_r2=-inf, complexity=152.50
[Gen  180] fitness=nan, val_mse=1.1644e+16, val_r2=-329081810776099456.0000, complexity=177.00
[Gen  190] fitness=nan, val_mse=4.8976e+05, val_r2=-13842079.9326, complexity=130.50
[Gen  200] fitness=nan, val_mse=1.5314e+10, val_r2=-432829083369.4293, complexity=153.00
[Gen  210] fitness=nan, val_mse=1.0048e+13, val_r2=-283983583984524.1250, complexity=149.50
[Gen  220] fitness=nan, val_mse=1.8181e+34, val_r2=-513858905000384986471045945540739072.0000, complexity=213.00
[Gen  230] fitness=nan, val_mse=2.6679e-02, val_r2=0.2460, complexity=165.50
[Gen  240] fitness=nan, val_mse=5.0878e+28, val_r2=-1437977742287188188348683386880.0000, complexity=111.00
[Gen  250] fitness=nan, val_mse=2.7201e-02, val_r2=0.2312, complexity=141.00
[Gen  260] fitness=nan, val_mse=2.6665e-02, val_r2=0.2464, complexity=211.00
[Gen  270] fitness=nan, val_mse=1.8891e+23, val_r2=-5339122041030892150849536.0000, complexity=117.50
[Gen  280] fitness=nan, val_mse=2.6640e-02, val_r2=0.2471, complexity=193.50
[Gen  290] fitness=nan, val_mse=1.5592e+25, val_r2=-440666442311976043866488832.0000, complexity=167.00

Best fitness: inf

============================================================
Phase 2b: Joint Training (MLP + Learnable Program Constants)
============================================================
Traceback (most recent call last):
  File "/u/gkerex/projects/IdealSummary/src/train_dsr.py", line 1248, in <module>
    main()
  File "/u/gkerex/projects/IdealSummary/src/train_dsr.py", line 1055, in main
    mlp_history, param_model = train_parameterized(
                               ^^^^^^^^^^^^^^^^^^^^
  File "/u/gkerex/projects/IdealSummary/src/train_dsr.py", line 650, in train_parameterized
    param_model = model.parameterize_constants()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/gkerex/projects/IdealSummary/src/set_dsr.py", line 606, in parameterize_constants
    return ParameterizedSetDSR(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/u/gkerex/projects/IdealSummary/src/set_dsr.py", line 638, in __init__
    for prog_idx, prog in enumerate(base_model.programs):
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable
